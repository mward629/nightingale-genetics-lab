<!DOCTYPE html>
<html>
<head>
    <title>Sandbox - Nightingale Genetics Lab</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body style="font-family: Arial; text-align:center;">

<h2>Sandbox Mode</h2>

<div>
    <label>Parent 1 Genotype:</label>
    <input id="p1" value="Bb">

    <label>Parent 2 Genotype:</label>
    <input id="p2" value="Bb">

    <label>Litter Size:</label>
    <input id="litter" value="8">

    <button onclick="generate()">Generate Puppies</button>
</div>

<h3>Offspring:</h3>
<div id="results"></div>

<h3>Observed Genotype Distribution</h3>
<canvas id="chart" width="400" height="200"></canvas>

<script>
let chart;

async function generate() {
    const response = await fetch("/generate", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({
            parent1: document.getElementById("p1").value,
            parent2: document.getElementById("p2").value,
            litter: document.getElementById("litter").value
        })
    });

    const data = await response.json();

    document.getElementById("results").innerText =
        data.offspring.join(", ");

    updateChart(data.offspring);
}

function updateChart(offspring) {

    let counts = {};
    offspring.forEach(g => {
        counts[g] = (counts[g] || 0) + 1;
    });

    const labels = Object.keys(counts);
    const values = Object.values(counts);

    const ctx = document.getElementById("chart").getContext("2d");

    if (chart) {
        chart.destroy();
    }

    chart = new Chart(ctx, {
        type: "bar",
        data: {
            labels: labels,
            datasets: [{
                label: "Observed Count",
                data: values
            }]
        },
        options: {
            responsive: false
        }
    });
}
</script>

</body>
</html>
